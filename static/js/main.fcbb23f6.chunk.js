(this["webpackJsonpcurrency-converter"]=this["webpackJsonpcurrency-converter"]||[]).push([[0],{38:function(e,t,r){},41:function(e,t,r){},42:function(e,t,r){},43:function(e,t,r){},44:function(e,t,r){},45:function(e,t,r){},46:function(e,t,r){},47:function(e,t,r){},48:function(e,t,r){},49:function(e,t,r){},52:function(e,t,r){"use strict";r.r(t);var n=r(0),c=r(10),a=r.n(c),s=r(11),u=r(12),i=r(16),o=r(15),l=r(13),d=r(18),b=r(23),j=r(9),v=r.n(j),p=function(e){return e>=.1?+e.toFixed(2):e<.1&&e>0?+e.toFixed(3):0===e?0:void 0},y=(v.a.string,v.a.number,function(e){return"current"===e?"converted":"current"}),h=function(e,t,r,n){!t||"click"!==e.type&&"Tab"!==e.key||e.target.getAttribute("data-element-type")!==r&&n()},f=function(e,t){return e?p(+e*t):""},O=Object(b.a)("path"),m=Object(b.a)("key"),x=Object(b.a)("formatResult"),T=new(function(){function e(){Object(s.a)(this,e),Object.defineProperty(this,O,{writable:!0,value:"https://currate.ru/api/?get=rates&pairs="}),Object.defineProperty(this,m,{writable:!0,value:"&key=c2ce7bb0c7510d68824e52174a9e452a"}),this._errorHandler=function(e){switch(e.status){case"500":throw new Error("Misspelled request");case"403":throw new Error("Invalid api-key");default:return}},Object.defineProperty(this,x,{writable:!0,value:function(e,t){return t.map((function(t){return e[t]}))}})}return Object(u.a)(e,[{key:"getCourse",value:function(e){var t=this;if(e[0]===e[1])return new Promise((function(e){return e([1,1])}));var r="".concat(e[0],",").concat(e[1]);return fetch(Object(d.a)(this,O)[O]+r+Object(d.a)(this,m)[m]).then((function(e){return e.json()})).then((function(r){return t._errorHandler(r),Object(d.a)(t,x)[x](r.data,e)})).catch((function(e){throw e}))}},{key:"getAllCourses",value:function(e,t){var r=this,n=t.reduce((function(t,r){return t+"".concat(e).concat(r,",")}),"");return fetch(Object(d.a)(this,O)[O]+n+Object(d.a)(this,m)[m]).then((function(e){return e.json()})).then((function(e){for(var t in r._errorHandler(e),e.data)e.data[t]=p(Number(e.data[t]));return e.data})).catch((function(e){throw e}))}}]),e}()),C=function(e){return{type:"SET_LIST_STATUS",payload:e}},E=function(e,t,r){return function(n,c){var a=c().currenciesTable,s=a.activeStatus,u=a.isLoading,i=a.error;n({type:"SET_TABLE_STATUSES",payload:{activeStatus:void 0!==e?e:s,isLoading:void 0!==t?t:u,error:void 0!==r?r:i}})}},g=(r(38),r(1)),S=function(){return Object(g.jsx)("div",{className:"error-indicator",children:Object(g.jsx)("p",{children:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a"})})},_=function(e){Object(i.a)(r,e);var t=Object(o.a)(r);function r(){var e;Object(s.a)(this,r);for(var n=arguments.length,c=new Array(n),a=0;a<n;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).state={hasError:!1},e}return Object(u.a)(r,[{key:"componentDidCatch",value:function(){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?Object(g.jsx)(S,{}):this.props.children}}]),r}(n.Component),k=r(17),L=r.n(k),N=r(22),R=r(14),w=(r(41),function(e){var t=e.onInputChange,r=e.type,n=e.currencyValue,c=function(e){t({type:r,value:""}),e.target.blur()};return Object(g.jsxs)("div",{className:"converter__input-block",children:[Object(g.jsx)("input",{type:"text",value:n,onChange:function(e){var c=e.target.value;(c=function(e){var t,r=null===(t=e.match(/^\.|^,|[^\d.,]|[.,]\d+[.,]|([.,]{2})/gm))||void 0===t?void 0:t[0];if(r){var n=e.indexOf(r);e=e.slice(0,n)+e.slice(n+1)}"0"===e[0]&&e.length>1&&"."!==e[1]&&(e=e.slice(1));var c=e.indexOf(",");return-1!==c&&(e=e.slice(0,c)+"."+e.slice(c+1)),e}(c))!==n&&t({type:r,value:c})},maxLength:15}),Object(g.jsx)("span",{onClick:c,onKeyDown:function(e){"Enter"===e.key&&c(e)},className:"converter__input-clear",tabIndex:"0",children:"\xd7"})]})}),A=(r(42),function(e){var t=e.dataType,r=void 0===t?"":t,n=e.onClick,c=e.children,a=e.classNames,s=void 0===a?"":a;return Object(g.jsxs)("button",{"data-element-type":r,className:"selected-currency-button ".concat(s),onClick:n,children:[c,Object(g.jsx)("i",{className:"fa--converter fa fa-angle-down","data-element-type":r})]})}),D=(r(43),function(e){var t=e.children,r=e.classNames,n=void 0===r?"":r,c=e.dataType,a=void 0===c?"":c,s=e.onClick,u=void 0===s?function(){}:s,i=function(e){e.target.dataset.elementType===a&&("Enter"!==e.key&&"click"!==e.type||u(e.target.dataset.elementValue))};return Object(g.jsx)("ul",{className:"currency-list ".concat(n),onKeyDown:i,onClick:i,children:t.map((function(e,t){return Object(g.jsx)("li",{className:"currency-list-item","data-element-type":a,"data-element-value":e,tabIndex:"0",children:e},t)}))})}),U=r(55),V=(r(44),function(e){var t=e.dataType,r=e.toggleHandler,n=e.activeStatus,c=e.currency,a=e.currencyList,s=e.currencyListClickHandler,u=void 0===s?function(){}:s;return Object(g.jsxs)("div",{className:"converter__currency-type-block",children:[Object(g.jsx)(U.a,{in:n,timeout:200,children:function(e){return Object(g.jsx)(A,{dataType:t,onClick:r,classNames:e,children:c})}}),Object(g.jsx)(U.a,{in:n,timeout:200,mountOnEnter:!0,unmountOnExit:!0,children:function(e){return Object(g.jsx)(D,{dataType:t,classNames:e,onClick:u,children:a})}})]})}),I=V,H=(r(45),{addCurrencyValue:function(e){return{type:"ADD_CURRENCY_VALUE",payload:e}},setListStatus:C,setCurrency:function(e){return{type:"SET_CURRENCY",payload:e}}}),P=Object(l.b)((function(e){var t=e.converter,r=e.currencyList;return{converter:{current:{value:t.current.value,currency:t.current.currency},converted:{value:t.converted.value,currency:t.converted.currency},dataType:t.dataType,listsStatus:t.listsStatus},currencyList:r}}),H)((function(e){var t=e.type,r=e.converter,n=e.setListStatus,c=e.setCurrency,a=e.fetch,s=e.addCurrencyValue,u=e.currencyList,i=function(){var e=y(t),c=Object(R.a)({},t,!r.listsStatus[t]);r.listsStatus[e]&&(c[e]=!1),n(c)},o=function(){var e=Object(N.a)(L.a.mark((function e(r){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c({type:t,value:r});case 2:return e.next=4,a();case 4:i();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(g.jsxs)("div",{className:"converter__currency-block",children:[Object(g.jsx)(w,{onInputChange:function(e){return s(e)},currencyValue:r[t].value,type:t}),Object(g.jsx)(I,{dataType:r.dataType,toggleHandler:i,activeStatus:r.listsStatus[t],currency:r[t].currency,currencyList:u,currencyListClickHandler:o})]})})),B=(r(46),function(e){var t=e.rowTypes,r=e.fetch;return Object(g.jsx)("main",{className:"converter",children:Object(g.jsx)("div",{className:"converter__wrapper",children:t.map((function(e){var t=e.id,n=e.type;return Object(g.jsx)(P,{type:n,fetch:r},t)}))})})}),Y=function(e){Object(i.a)(r,e);var t=Object(o.a)(r);function r(){var e;Object(s.a)(this,r);for(var n=arguments.length,c=new Array(n),a=0;a<n;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).rowTypes=[{id:0,type:"current"},{id:1,type:"converted"}],e.listDisabler=function(t){var r=e.props.converter,n=r.dataType,c=r.listsStatus,a=c.current,s=c.converted;h(t,a||s,n,(function(){return e.props.setListStatus({current:!1,converted:!1})}))},e}return Object(u.a)(r,[{key:"componentDidMount",value:function(){this.props.fetchPairValue(),document.addEventListener("click",this.listDisabler),document.addEventListener("keyup",this.listDisabler)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.listDisabler),document.removeEventListener("keyup",this.listDisabler)}},{key:"render",value:function(){var e=this.props.converter.error.status;return Object(g.jsx)(_,{children:e&&Object(g.jsx)(S,{})||Object(g.jsx)(B,{rowTypes:this.rowTypes,fetch:this.props.fetchPairValue})})}}]),r}(n.Component),F={fetchPairValue:function(){return function(e,t){var r=t().converter,n=r.current.currency,c=r.converted.currency,a=[n+c,c+n];T.getCourse(a).then((function(t){return e({type:"FETCH_PAIR_VALUE",payload:t})})).catch((function(t){return e({type:"SET_CONVERTER_ERROR",payload:{error:{status:!0,message:t.message}}})}))}},setListStatus:C},M=Object(l.b)((function(e){var t=e.converter;return{converter:{current:{currency:t.current.currency},converted:{currency:t.converted.currency},dataType:t.dataType,listsStatus:t.listsStatus,error:t.error}}}),F)(Y),J=(r(47),function(e){var t=e.children;return Object(g.jsx)("div",{className:"spinner ".concat(t),children:Object(g.jsx)("div",{className:"loadingio-spinner-eclipse-p19pnm2p23",children:Object(g.jsx)("div",{className:"ldio-pnzr8yywkb",children:Object(g.jsx)("div",{})})})})}),K=r(30),W=function(e){var t=e.children;return Object(g.jsx)("tbody",{children:Object.entries(t).map((function(e,t){var r=Object(K.a)(e,2),n=r[0],c=r[1];return Object(g.jsxs)("tr",{className:"currency-table__row",children:[Object(g.jsxs)("td",{children:[n.slice(0,3),"/",n.slice(3)]}),Object(g.jsx)("td",{children:c})]},t)}))})},q=(r(48),function(e){var t=e.children,r=t.headerValues,n=t.bodyValues;return Object(g.jsx)("div",{className:"currency-table__wrapper",children:Object(g.jsxs)("table",{className:"currency-table",children:[Object(g.jsx)("thead",{children:Object(g.jsx)("tr",{className:"currency-table__row",children:r.map((function(e){var t=e.id,r=e.value;return Object(g.jsx)("th",{children:r},t)}))})}),Object(g.jsx)(W,{children:n})]})})}),z=function(e){Object(i.a)(r,e);var t=Object(o.a)(r);function r(){var e;Object(s.a)(this,r);for(var n=arguments.length,c=new Array(n),a=0;a<n;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).spinnerClassname="currencies-table",e.tableHeaderValues=[{id:1,value:"\u0412\u0430\u043b\u044e\u0442\u0430"},{id:2,value:"\u0426\u0435\u043d\u0430"}],e.toggle=function(){return e.props.setTableStatuses(!e.props.currenciesTable.activeStatus)},e.sendCurrency=function(){var t=Object(N.a)(L.a.mark((function t(r){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.props.setCurrencyInTable(r);case 2:e.props.addCurrenciesValues();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.listDisabler=function(t){var r=e.props.currenciesTable,n=r.dataType,c=r.activeStatus;h(t,c,n,(function(){return e.props.setTableStatuses(!1)}))},e}return Object(u.a)(r,[{key:"componentDidMount",value:function(){this.props.addCurrenciesValues(),document.addEventListener("click",this.listDisabler),document.addEventListener("keyup",this.listDisabler)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.listDisabler),document.removeEventListener("keyup",this.listDisabler)}},{key:"render",value:function(){var e,t=this.props,r=t.currencyList,n=t.currenciesTable,c=n.currentCurrency,a=n.values,s=n.dataType,u=n.activeStatus,i=n.isLoading,o=n.error.status,l={headerValues:this.tableHeaderValues,bodyValues:a};return o||i?i?e=Object(g.jsx)(J,{children:this.spinnerClassname}):o&&(e=Object(g.jsx)(S,{})):e=Object(g.jsx)(q,{children:l}),Object(g.jsx)(_,{children:Object(g.jsxs)("div",{className:"currency-table__component",children:[e,Object(g.jsx)(V,{dataType:s,toggleHandler:this.toggle,activeStatus:u,currency:c,currencyList:r,currencyListClickHandler:this.sendCurrency})]})})}}]),r}(n.Component),G={addCurrenciesValues:function(){return function(e,t){var r=t(),n=r.currencyList,c=r.currenciesTable.currentCurrency;E(!1,!0,{status:!1,message:null})(e,t),T.getAllCourses(c,n).then((function(t){return e({type:"ADD_CURRENCIES_VALUES",payload:t})})).catch((function(r){return E(void 0,!1,{status:!0,message:r.message})(e,t)})).finally((function(){return E(void 0,!1)(e,t)}))}},setCurrencyInTable:function(e){return{type:"SET_CURRENCY_IN_TABLE",payload:e}},setTableStatuses:E},Q=Object(l.b)((function(e){return{currencyList:e.currencyList,currenciesTable:e.currenciesTable}}),G)(z),X=r(20),Z=r(4),$=(r(49),function(){return Object(g.jsxs)("div",{className:"switch-buttons",children:[Object(g.jsx)(X.b,{to:"/",activeClassName:"active",exact:!0,children:"\u041a\u043e\u043d\u0432\u0435\u0440\u0442\u0435\u0440"}),Object(g.jsx)(X.b,{to:"/currencies-table",activeClassName:"active",children:"\u0422\u0430\u0431\u043b\u0438\u0446\u0430 \u0432\u0430\u043b\u044e\u0442"})]})}),ee=function(){return Object(g.jsx)(X.a,{children:Object(g.jsxs)("div",{className:"currencies-app",children:[Object(g.jsx)($,{}),Object(g.jsxs)(Z.d,{children:[Object(g.jsx)(Z.b,{path:"/",component:M,exact:!0}),Object(g.jsx)(Z.b,{path:"/currencies-table",component:Q}),Object(g.jsx)(Z.a,{to:"/"})]})]})})},te=r(28),re=r(29),ne=r(2),ce={current:{currency:"USD",value:1,exchangeRate:""},converted:{currency:"RUB",value:"",exchangeRate:""},listsStatus:{current:!1,converted:!1},dataType:"currency-converter-item",error:{status:!1,message:null}},ae=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case"FETCH_PAIR_VALUE":var n=t.current.value,c=n?p(n*r.payload[0]):"";return Object(ne.a)(Object(ne.a)({},t),{},{current:Object(ne.a)(Object(ne.a)({},t.current),{},{exchangeRate:r.payload[0]}),converted:Object(ne.a)(Object(ne.a)({},t.converted),{},{value:c,exchangeRate:r.payload[1]})});case"ADD_CURRENCY_VALUE":var a=r.payload,s=a.type,u=a.value,i=y(s),o=f(u,t[s].exchangeRate);return Object(ne.a)(Object(ne.a)({},t),{},(e={},Object(R.a)(e,s,Object(ne.a)(Object(ne.a)({},t[s]),{},{value:u||""})),Object(R.a)(e,i,Object(ne.a)(Object(ne.a)({},t[i]),{},{value:o})),e));case"SET_CURRENCY":return Object(ne.a)(Object(ne.a)({},t),{},Object(R.a)({},r.payload.type,Object(ne.a)(Object(ne.a)({},t[r.payload.type]),{},{currency:r.payload.value})));case"SET_LIST_STATUS":return Object(ne.a)(Object(ne.a)({},t),{},{listsStatus:Object(ne.a)(Object(ne.a)({},t.listsStatus),r.payload)});case"SET_CONVERTER_ERROR":return Object(ne.a)(Object(ne.a)({},t),r.payload);default:return t}},se={values:{},currentCurrency:"USD",dataType:"currency-table-item",activeStatus:!1,isLoading:!0,error:{status:!1,message:null}},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_CURRENCIES_VALUES":return Object(ne.a)(Object(ne.a)({},e),{},{values:t.payload});case"SET_CURRENCY_IN_TABLE":return Object(ne.a)(Object(ne.a)({},e),{},{currentCurrency:t.payload});case"SET_TABLE_STATUSES":return Object(ne.a)(Object(ne.a)({},e),t.payload);default:return e}},ie={currencyList:["RUB","USD","EUR","GBP","BYN"]},oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;return Object(ne.a)(Object(ne.a)({},e),{},{converter:ae(e.converter,t),currenciesTable:ue(e.currenciesTable,t)})},le=Object(te.b)(oe,Object(te.a)(re.a,(function(){return function(e){return function(t){return console.log(t.type),console.log(t.payload),e(t)}}})));a.a.render(Object(g.jsx)(l.a,{store:le,children:Object(g.jsx)(ee,{})}),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.fcbb23f6.chunk.js.map